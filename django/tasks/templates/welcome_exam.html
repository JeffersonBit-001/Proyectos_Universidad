{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow-lg border-0">
                <div class="card-header bg-primary text-white text-center py-4">
                    <h2 class="mb-0"><i class="fas fa-user-graduate me-2"></i>Bienvenido al Examen</h2>
                    <p class="mb-0 mt-2 text-white-50">Identificador: #{{ examen_id }}</p>
                </div>
                <div class="card-body p-5">
                    
                    <div class="alert alert-info mb-4">
                        <i class="fas fa-info-circle"></i> 
                        Antes de iniciar, el sistema verificará que tu entorno sea seguro.
                    </div>

                    <div class="card mb-4 bg-light">
                        <div class="card-header bg-secondary text-white">
                            <i class="fas fa-shield-alt me-2"></i> Verificación de Entorno
                        </div>
                        <div class="card-body">
                            
                            <div class="row mb-3 text-center">
                                <div class="col-md-6 mb-2">
                                    <p class="mb-1 fw-bold">Agente de Seguridad</p>
                                    <span id="check-agent" class="badge bg-danger rounded-pill p-2 w-75">PENDIENTE</span>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <p class="mb-1 fw-bold">Navegador Limpio</p>
                                    <span id="check-browser" class="badge bg-danger rounded-pill p-2 w-75">PENDIENTE</span>
                                </div>
                            </div>

                            <hr>
                            <h6 class="text-center mb-3 text-muted">Aplicaciones Prohibidas Monitorizadas</h6>

                            <div id="dynamic-apps-container" class="row text-center justify-content-center g-2">
                                <div class="col-12 text-muted py-3">
                                    <div class="spinner-border spinner-border-sm text-primary" role="status"></div>
                                    <small class="ms-2">Cargando lista de aplicaciones...</small>
                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="progress mb-3" style="height: 25px;">
                        <div id="proctor-progress-bar" 
                             class="progress-bar progress-bar-striped progress-bar-animated bg-warning" 
                             role="progressbar" 
                             style="width: 0%;" 
                             aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                             0%
                        </div>
                    </div>
                    
                    <p id="proctor-status-message" class="text-center text-muted fw-bold mb-4">
                        Esperando conexión con el agente...
                    </p>

                    <div class="d-grid gap-2">
                        <button id="start-exam-button" class="btn btn-secondary btn-lg" disabled 
                                data-url="{% url 'exam_page' examen_id %}">
                            Verificando Requisitos...
                        </button>
                        
                        <a href="{% url 'exam_dashboard' %}" class="btn btn-outline-danger mt-2">
                            <i class="fas fa-arrow-left"></i> Volver al Panel
                        </a>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}